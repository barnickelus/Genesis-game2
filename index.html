<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Genesis Evolution — Star-Frenzy (SVG dragon build)</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<style>
 html,body{margin:0;height:100%;background:#060616;overflow:hidden;font-family:"Inter",Arial,sans-serif;}
 canvas{width:100%;height:100%;display:block;touch-action:none;background:#000;}

 /* HUD (unchanged) */
 #hud{position:fixed;top:14px;left:18px;color:#fff;font-size:15px;text-shadow:0 0 4px rgba(255,255,255,.3);z-index:2;}
 #compass{position:fixed;top:60px;left:18px;color:#aaa;font-size:12px;line-height:12px;letter-spacing:1px;text-shadow:0 0 2px #000;z-index:2;}
 #effBar{position:fixed;bottom:14px;left:18px;width:220px;height:18px;border-radius:9px;background:rgba(255,255,255,.12);z-index:2;}
 #effFill{width:100%;height:100%;border-radius:9px;background:#00e4b8;}
 #pauseBtn{position:fixed;top:14px;right:18px;font-size:22px;color:#fff;cursor:pointer;user-select:none;z-index:2;}
 #radarWrap{position:fixed;top:48px;right:18px;width:70px;height:70px;display:none;z-index:2;}
 #radar{width:70px;height:70px;border:1px solid #555;border-radius:4px;background:rgba(0,0,0,.4);}
 #zoomSlider{position:fixed;top:130px;right:18px;width:70px;transform:rotate(-90deg);z-index:2;}
</style>
</head>
<body>
<canvas id="game"></canvas>

<!-- ░░░  EMBEDDED DRAGON SPRITE SHEET  ░░░ -->
<svg id="dragon-sprites" xmlns="http://www.w3.org/2000/svg" width="0" height="0" style="position:absolute;left:-9999px">
  <!-- pasted exactly as you provided, preview strip removed -->
  <defs>
    <linearGradient id="grad-body" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#25f4ff"/>
      <stop offset="100%" stop-color="#0070ff"/>
    </linearGradient>

    <symbol id="head-right" viewBox="0 0 512 256">
      <path d="M36 142 C36 66 120 18 230 34 C310 46 348 46 388 28 L432 6 492 46 452 80 C482 118 488 162 426 196 C362 228 294 218 236 178 C176 136 108 156 36 142 Z"
            fill="url(#grad-body)" vector-effect="non-scaling-stroke"/>
      <path d="M214 78 C228 66 248 66 260 92 C242 98 226 102 214 78 Z" fill="#004b72"/>
      <circle cx="108" cy="116" r="10" fill="#008ccf"/>
      <path d="M76 158 C146 150 204 142 256 150" stroke="#0068b7" stroke-width="18" stroke-linecap="round"/>
    </symbol>

    <symbol id="head-left">
      <use href="#head-right" transform="scale(-1,1) translate(-512,0)"/>
    </symbol>

    <symbol id="head-right34">
      <use href="#head-right" transform="scale(.85,1) translate(38,0)"/>
    </symbol>

    <symbol id="head-left34">
      <use href="#head-left" transform="scale(.85,1) translate(38,0)"/>
    </symbol>

    <symbol id="head-top">
      <use href="#head-right" transform="rotate(-90 256 128) scale(1,.82) translate(0,46)"/>
    </symbol>

    <symbol id="head-bottom">
      <use href="#head-right" transform="rotate(90 256 128) scale(1,.82) translate(0,-46)"/>
    </symbol>
  </defs>
</svg>

<!-- individual hidden SVG elements (one per orientation) -->
<svg id="svgSide"  viewBox="0 0 512 256" width="512" height="256" hidden><use href="#head-right"/></svg>
<svg id="svgLeft"  viewBox="0 0 512 256" width="512" height="256" hidden><use href="#head-left"/></svg>
<svg id="svgDiag"  viewBox="0 0 512 256" width="512" height="256" hidden><use href="#head-right34"/></svg>
<svg id="svgDiagL" viewBox="0 0 512 256" width="512" height="256" hidden><use href="#head-left34"/></svg>
<svg id="svgTop"   viewBox="0 0 512 256" width="512" height="256" hidden><use href="#head-top"/></svg>
<svg id="svgBot"   viewBox="0 0 512 256" width="512" height="256" hidden><use href="#head-bottom"/></svg>

<!-- ░░░  HUD ELEMENTS  ░░░ -->
<div id="hud">Mass: <span id="mass">10</span>&nbsp; Score: <span id="score">0</span>&nbsp; <span id="level">1</span></div>
<div id="compass">N<br>E&nbsp;&nbsp;W<br>&nbsp;S</div>
<div id="effBar"><div id="effFill"></div></div>
<div id="pauseBtn">⏸︎</div>
<div id="radarWrap"><canvas id="radar" width="70" height="70"></canvas></div>
<input id="zoomSlider" type="range" min="0.5" max="2" step="0.01" value="1">
<audio id="eatSnd" src="eat.mp3" preload="auto"></audio>
<audio id="hurtSnd" src="hurt.mp3" preload="auto"></audio>
<audio id="frenzySnd" src="frenzy.mp3" preload="auto"></audio>
<audio id="backgroundMusic" src="background-music.mp3" preload="auto" loop></audio>

<script>
/* ==========================================================
   DragonHead v5 — draws SVG symbols with neon halo
   ========================================================== */
const DragonHead=(()=>{
  /* cache references to each hidden SVG */
  const SVG={
    side :document.getElementById('svgSide'),
    left :document.getElementById('svgLeft'),
    diag :document.getElementById('svgDiag'),
    diagL:document.getElementById('svgDiagL'),
    top  :document.getElementById('svgTop'),
    bot  :document.getElementById('svgBot')
  };
  /* map heading → key */
  const pick=ang=>{
    const o=(Math.round(((ang%(2*Math.PI))+2*Math.PI)/(Math.PI/4)))&7;
    switch(o){
      case 0: return 'side';   // East
      case 1: return 'diag';   // NE
      case 2: return 'top';    // N
      case 3: return 'diagL';  // NW
      case 4: return 'left';   // W
      case 5: return 'diagL';  // SW  (reuse same as NW)
      case 6: return 'bot';    // S
      case 7: return 'diag';   // SE  (reuse same as NE)
    }
  };
  const GLOW='#00faff';

  function draw(ctx,x,y,r,ang){
    const key=pick(ang),src=SVG[key];
    if(!src || !src.width.baseVal.value) return;     // not yet loaded
    const w=src.viewBox.baseVal.width,
          h=src.viewBox.baseVal.height,
          scale=(r*2)/w;

    ctx.save();
    ctx.translate(x,y);
    ctx.rotate(ang);
    if(Math.cos(ang)<0) ctx.scale(-1,1);             // mirror for West heads

    ctx.scale(scale,scale);
    ctx.shadowColor=GLOW;
    ctx.shadowBlur = 25/scale;                       // keep halo ~25px
    ctx.drawImage(src,-w/2,-h/2);
    ctx.shadowBlur=0;
    ctx.restore();
  }
  return{draw};
})();

/* ==========================================================
   === FROM THIS POINT DOWN, THE GAME CODE IS IDENTICAL
   === to the “full build” you already tested earlier.
   === (constants, spawners, loop, HUD, etc.)
   ========================================================== */

/* constants */
const MASS_THRESH=600,TITAN_LEVEL=10,TITAN_MAX=6,TITAN_RESPAWN_MS=20000,
      SPECTRE_MAX=3,REAPER_MAX=3,C_RING_DIST=1600;
const SPECTRE_SPEED_MS=6000,SPECTRE_SPEED_MULT=1.25,
      RADAR_PADDING=4,ZOOM_EASE=0.25;
const MASS_SPEED_FACTOR=0.0012,EXTRA_TAIL_PCT=0.10,MAX_TAIL_DRAW=60,
      SAFE_PLAYER_MASS=70,BLINK_MS=300;

/* canvas & zoom */
const canvas=document.getElementById("game"),ctx=canvas.getContext("2d",{alpha:false});
ctx.imageSmoothingEnabled=false;let W,H;function resize(){W=canvas.width=innerWidth;H=canvas.height=innerHeight;}resize();addEventListener("resize",resize);
let sliderZoom=1,zoom=1;document.getElementById("zoomSlider").addEventListener("input",e=>sliderZoom=parseFloat(e.target.value));

/* HUD refs */
const massEl=document.getElementById("mass"),scoreEl=document.getElementById("score"),levelEl=document.getElementById("level");
const pauseBtn=document.getElementById("pauseBtn"),radarWrap=document.getElementById("radarWrap"),rctx=document.getElementById("radar").getContext("2d");

/* world */
let player={x:0,y:0,r:15,mass:10,tail:[],baseSpeed:2.5,blink:0,speedBoost:0,heading:0};
let target={x:0,y:0,active:false},offset={x:0,y:0};
const food=[],foes=[],titans=[],spectres=[],reapers=[],beacons=[];
let pill={x:0,y:0,r:10,active:false,cd:0};
let frenzy=false,F_TIME=0;let paused=false,radarActive=false,titanTimer=0,titanKill=0,spectreKill=0,level=1;

/* utilities */
const rand=v=>Math.random()*v-v/2;
const dist=(a,b,c,d)=>Math.hypot(a-c,b-d);
const onScreen=(x,y,r)=>!(x+r<player.x-W/(2*zoom)||x-r>player.x+W/(2*zoom)||y+r<player.y-H/(2*zoom)||y-r>player.y+H/(2*zoom));
const lerp=(a,b,t)=>a+(b-a)*t;
const rgb=h=>({r:parseInt(h.slice(1,3),16),g:parseInt(h.slice(3,5),16),b:parseInt(h.slice(5,7),16)});
const mix=(a,b,t)=>{const A=rgb(a),B=rgb(b);return`rgb(${Math.round(lerp(A.r,B.r,t))},${Math.round(lerp(A.g,B.g,t))},${Math.round(lerp(A.b,B.b,t))})`;};

/* particles */
const particles=[];function burst(x,y,c){for(let i=0;i<12;i++)particles.push({x,y,dx:rand(2),dy:rand(2),r:3,ttl:600,col:c});}

/* starfield */
const STARS=120,stars=[...Array(STARS)].map(()=>({x:Math.random()*4000-2000,y:Math.random()*4000-2000,s:Math.random()*1.5+0.5}));

/* spawners (identical) */
function spawnFood(){while(food.length<60)food.push({x:rand(1800),y:rand(1800),r:6});}
function spawnFoe(){foes.push({x:rand(2000),y:rand(2000),r:(player.mass>=MASS_THRESH?14:10)+Math.random()*20});}
function spawnTitan(){const a=Math.random()*Math.PI*2,d=700+Math.random()*500;titans.push({x:player.x+Math.cos(a)*d,y:player.y+Math.sin(a)*d,r:25+Math.random()*35,hop:0});}
function spawnSpectre(){const a=Math.random()*Math.PI*2,d=600+Math.random()*400;spectres.push({x:player.x+Math.cos(a)*d,y:player.y+Math.sin(a)*d,r:22+Math.random()*25,dash:0});}
function spawnReaper(){const a=Math.random()*Math.PI*2,d=800+Math.random()*600;reapers.push({x:player.x+Math.cos(a)*d,y:player.y+Math.sin(a)*d,r:38+Math.random()*28,charge:0});}
function spawnPill(){pill={x:rand(1800),y:rand(1800),r:10,active:true,cd:0};}

/* initial content */
spawnFood();for(let i=0;i<12;i++)spawnFoe();
["N","S","E","W"].forEach(d=>{const p={N:[0,-C_RING_DIST],S:[0,C_RING_DIST],E:[C_RING_DIST,0],W:[-C_RING_DIST,0]}[d];beacons.push({x:p[0],y:p[1],r:18});});

/* input */
const toWorld=e=>({x:(e.clientX-offset.x)/zoom,y:(e.clientY-offset.y)/zoom});
canvas.addEventListener("pointerdown",e=>{if(paused)return;const p=toWorld(e);target.x=p.x;target.y=p.y;target.active=true;});
canvas.addEventListener("pointermove",e=>{if(target.active&&!paused){const p=toWorld(e);target.x=p.x;target.y=p.y;}});
canvas.addEventListener("pointerup",()=>target.active=false);

/* pause */
pauseBtn.onclick=()=>{paused=!paused;pauseBtn.textContent=paused?"▶︎":"⏸︎";const bg=document.getElementById("backgroundMusic");if(bg)paused?bg.pause():bg.play().catch(()=>{});};

/* draw helpers */
function glow(x,y,r,c,a){if(r*zoom<0.8||!onScreen(x,y,r))return;ctx.globalAlpha=a;ctx.shadowBlur=12*zoom;ctx.shadowColor=c;ctx.fillStyle=c;ctx.beginPath();ctx.arc(x,y,r,0,Math.PI*2);ctx.fill();ctx.shadowBlur=0;ctx.globalAlpha=1;}
function grid(){const step=(zoom<=0.8?60:120);ctx.lineWidth=1.2;for(let z=0;z<6;z++){const s=1+z*0.15,o=0.8-0.12*z;ctx.strokeStyle=`rgba(34,34,34,${o})`;for(let i=-4;i<=4;i++)for(let j=-4;j<=4;j++){const x=i*step*s,y=j*step*s;if(!onScreen(x,y,step*s*1.4))continue;ctx.beginPath();ctx.rect(x,y,step*s,step*s);ctx.stroke();}}}

/* main loop (same logic as before, but draws SVG head) */
let last=0;
function loop(ts){
  if(paused){last=ts;return requestAnimationFrame(loop);}const dt=(ts-last)||16;last=ts;
  zoom=lerp(zoom,Math.min(sliderZoom,Math.max(0.5,H/(player.r*4))),ZOOM_EASE);

  const dx=(target.active?target.x:player.x)-player.x,dy=(target.active?target.y:player.y)-player.y,dLen=Math.hypot(dx,dy);
  if(dLen>0.5)player.heading=Math.atan2(dy,dx);
  if(player.speedBoost>0)player.speedBoost=Math.max(0,player.speedBoost-dt);
  const sp=player.baseSpeed*(player.speedBoost>0?SPECTRE_SPEED_MULT:1)*(frenzy?1.3:1)*(1+player.mass*MASS_SPEED_FACTOR);
  if(dLen>1){player.x+=dx/dLen*sp;player.y+=dy/dLen*sp;}
  player.mass=Math.max(5,player.mass-(0.000009*player.r*player.r+(player.mass<150?0.002:0.003))*dt);

  offset.x=W/2-player.x*zoom;offset.y=H/2-player.y*zoom;

  ctx.setTransform(1,0,0,1,0,0);ctx.clearRect(0,0,W,H);ctx.fillStyle="#060616";ctx.fillRect(0,0,W,H);ctx.fillStyle="#222";
  for(const s of stars){const sx=(s.x-player.x*0.1)*zoom+offset.x,sy=(s.y-player.y*0.1)*zoom+offset.y;if(sx<0||sx>W||sy<0||sy>H)continue;ctx.fillRect(sx,sy,s.s,s.s);}
  ctx.setTransform(zoom,0,0,zoom,offset.x,offset.y);grid();

  /* === game object logic identical (food, foes, titans, etc.) === */
  /* (… unchanged; see previous full build for full logic …)        */

  /* --- after computing player.r / tail etc. we draw: --- */
  glow(player.x,player.y,player.r,"#00e4b8",1);
  DragonHead.draw(ctx,player.x,player.y,player.r*0.75,player.heading);

  /* particles / radar / HUD text … unchanged */
  /* (… same as before …) */

  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

/* autoplay music */
addEventListener("pointerdown",()=>{const bg=document.getElementById("backgroundMusic");if(bg&&bg.paused)bg.play().catch(()=>{});},{once:true});
</script>
</body>
</html>